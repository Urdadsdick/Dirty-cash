-- Load the Orion Library
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()

-- Create Window
local Window = OrionLib:MakeWindow({
    Name = "Troll.God Premium Script for SW2",
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "TrollGodSW2"
})

-- Global Toggles
_G.fly = false
_G.speed = 50
_G.godmode = false
_G.invisible = false
_G.esp = false
_G.outlineColor = Color3.new(1, 0, 0) -- Red outline
_G.autoPickup = false
_G.infiniteAmmo = false
_G.doubleDamage = false
_G.onePunch = false

-- Helper Functions

-- Fly Toggle
local bodyGyro, bodyVelocity
local function toggleFly(state)
    local player = game.Players.LocalPlayer
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end
    
    local humanoidRootPart = player.Character.HumanoidRootPart

    if state then
        bodyGyro = Instance.new("BodyGyro", humanoidRootPart)
        bodyGyro.MaxTorque = Vector3.new(400000, 400000, 400000)
        bodyGyro.CFrame = humanoidRootPart.CFrame

        bodyVelocity = Instance.new("BodyVelocity", humanoidRootPart)
        bodyVelocity.MaxForce = Vector3.new(400000, 400000, 400000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)

        game:GetService("RunService").Heartbeat:Connect(function()
            if _G.fly then
                bodyVelocity.Velocity = humanoidRootPart.CFrame.LookVector * _G.speed
            end
        end)
    else
        if bodyGyro then bodyGyro:Destroy() end
        if bodyVelocity then bodyVelocity:Destroy() end
    end
end

-- Godmode
local function enableGodmode()
    local player = game.Players.LocalPlayer
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        local humanoid = player.Character.Humanoid
        humanoid.MaxHealth = math.huge
        humanoid.Health = math.huge
    end
end

-- Become Visible
local function becomeVisible()
    local player = game.Players.LocalPlayer
    if player.Character then
        for _, part in pairs(player.Character:GetChildren()) do
            if part:IsA("BasePart") then
                part.Transparency = 0
            end
        end
    end
end

-- Auto Pickup Items
local function enableAutoPickup()
    local player = game.Players.LocalPlayer
    if not player.Character then return end
    local character = player.Character

    game:GetService("RunService").Heartbeat:Connect(function()
        if _G.autoPickup and character then
            for _, item in pairs(workspace:GetDescendants()) do
                if item:IsA("BasePart") and (item.Position - character.PrimaryPart.Position).Magnitude < 10 then
                    firetouchinterest(character.HumanoidRootPart, item, 0)
                    firetouchinterest(character.HumanoidRootPart, item, 1)
                end
            end
        end
    end)
end

-- ESP & Wall Hacks
local function toggleESP(state)
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            if state then
                -- Create BillboardGui for ESP
                local billboard = Instance.new("BillboardGui", player.Character.HumanoidRootPart)
                billboard.Name = "ESP"
                billboard.Size = UDim2.new(1, 0, 1, 0)
                billboard.AlwaysOnTop = true

                -- Add TextLabel
                local text = Instance.new("TextLabel", billboard)
                text.Text = player.Name
                text.Size = UDim2.new(1, 0, 1, 0)
                text.BackgroundTransparency = 1
                text.TextColor3 = Color3.new(1, 0, 0) -- Red text
                text.TextScaled = true

                -- Add Outline
                local highlight = Instance.new("Highlight", player.Character)
                highlight.Name = "Outline"
                highlight.FillTransparency = 1
                highlight.OutlineTransparency = 0
                highlight.OutlineColor = _G.outlineColor
            else
                -- Remove ESP and Outline
                if player.Character.HumanoidRootPart:FindFirstChild("ESP") then
                    player.Character.HumanoidRootPart.ESP:Destroy()
                end
                if player.Character:FindFirstChild("Outline") then
                    player.Character.Outline:Destroy()
                end
            end
        end
    end
end

-- Auto-Update ESP for New Players
game.Players.PlayerAdded:Connect(function(newPlayer)
    newPlayer.CharacterAdded:Connect(function()
        if _G.esp then
            toggleESP(true)
        end
    end)
end)

-- One Punch with Fist Items
local function enableOnePunch()
    local player = game.Players.LocalPlayer
    local character = player.Character

    game:GetService("RunService").Heartbeat:Connect(function()
        if _G.onePunch and character then
            for _, otherPlayer in pairs(game.Players:GetPlayers()) do
                if otherPlayer ~= player and otherPlayer.Character then
                    local humanoid = otherPlayer.Character:FindFirstChild("Humanoid")
                    if humanoid and character:FindFirstChild("Fist") then
                        humanoid.Health = 0 -- Instantly kills the other player when punched with a fist
                    end
                end
            end
        end
    end)
end

-- Infinite Ammo
local function enableInfiniteAmmo()
    local player = game.Players.LocalPlayer
    if not player then return end

    local backpack = player.Backpack
    local character = player.Character

    for _, tool in pairs(backpack:GetChildren()) do
        if tool:FindFirstChild("Ammo") then
            tool.Ammo.Changed:Connect(function()
                if _G.infiniteAmmo then
                    tool.Ammo.Value = tool.Ammo.MaxValue
                end
            end)
        end
    end

    if character then
        for _, tool in pairs(character:GetChildren()) do
            if tool:FindFirstChild("Ammo") then
                tool.Ammo.Changed:Connect(function()
                    if _G.infiniteAmmo then
                        tool.Ammo.Value = tool.Ammo.MaxValue
                    end
                end)
            end
        end
    end
end

-- Tabs Creation

-- Gun Tab
local gunTab = Window:MakeTab({
    Name = "Gun",
    Icon = "rbxassetid://6034287518",
    PremiumOnly = false
})

gunTab:AddToggle({
    Name = "2x Damage",
    Default = false,
    Callback = function(Value)
        _G.doubleDamage = Value
    end
})

gunTab:AddToggle({
    Name = "Infinite Ammo",
    Default = false,
    Callback = function(Value)
        _G.infiniteAmmo = Value
        enableInfiniteAmmo()
    end
})

-- Annoying Tab
local annoyingTab = Window:MakeTab({
    Name = "Annoying",
    Icon = "rbxassetid://6034295701",
    PremiumOnly = false
})

annoyingTab:AddToggle({
    Name = "One Punch",
    Default = false,
    Callback = function(Value)
        _G.onePunch = Value
        enableOnePunch()
    end
})

-- AutoFarm Tab
local autoFarmTab = Window:MakeTab({
    Name = "AutoFarm",
    Icon = "rbxassetid://6034287518",
    PremiumOnly = false
})

autoFarmTab:AddToggle({
    Name = "Auto Pickup",
    Default = false,
    Callback = function(Value)
        _G.autoPickup = Value
        if Value then
            enableAutoPickup()
        end
    end
})

-- ESP Tab
local espTab = Window:MakeTab({
    Name = "ESP & Wall Hacks",
    Icon = "rbxassetid://6034304915",
    PremiumOnly = false
})

espTab:AddToggle({
    Name = "Enable ESP",
    Default = false,
    Callback = function(Value)
        _G.esp = Value
        toggleESP(Value)
    end
})

espTab:AddColorPicker({
    Name = "Outline Color",
    Default = _G.outlineColor,
    Callback = function(Value)
        _G.outlineColor = Value
        toggleESP(_G.esp)
    end
})

-- Initialize GUI
OrionLib:Init()
