-- Load Rayfield Library
local Rayfield = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Rayfield/main/source"))()

-- Create Window
local Window = Rayfield:CreateWindow({
    Name = "Troll.God Premium Script for SW2",
    LoadingTitle = "Troll.God",
    LoadingSubtitle = "Enjoy Trolling!",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "TrollGodSW2",
        FileName = "SW2_Config"
    },
    Discord = {
        Enabled = false,
    },
    KeySystem = false,
})

-- Global Variables
local selectedPlayer = nil
local speed = 16
local espEnabled = false
local autoPickupEnabled = false
local runService = game:GetService("RunService")
local players = game:GetService("Players")
local localPlayer = players.LocalPlayer

-- Utility Functions
local function killPlayer(targetPlayer)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Humanoid") then
        targetPlayer.Character.Humanoid.Health = 0
    end
end

local function enableESP()
    for _, player in pairs(players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            if not player.Character:FindFirstChild("Highlight") then
                local highlight = Instance.new("Highlight")
                highlight.Parent = player.Character
                highlight.FillTransparency = 1
                highlight.OutlineTransparency = 0
                highlight.OutlineColor = Color3.new(1, 0, 0) -- Red outline
            end
        end
    end
    espEnabled = true
end

local function disableESP()
    for _, player in pairs(players:GetPlayers()) do
        if player.Character and player.Character:FindFirstChild("Highlight") then
            player.Character.Highlight:Destroy()
        end
    end
    espEnabled = false
end

local function updateWalkSpeed(newSpeed)
    if localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
        localPlayer.Character.Humanoid.WalkSpeed = newSpeed
    end
end

local function autoPickupItems()
    runService.Heartbeat:Connect(function()
        if autoPickupEnabled and localPlayer.Character then
            for _, item in pairs(workspace:GetChildren()) do
                if item:IsA("Part") and (item.Position - localPlayer.Character.PrimaryPart.Position).Magnitude < 50 then
                    firetouchinterest(localPlayer.Character.PrimaryPart, item, 0)
                    firetouchinterest(localPlayer.Character.PrimaryPart, item, 1)
                end
            end
        end
    end)
end

-- Tabs and Features
-- Player Tab
local PlayerTab = Window:CreateTab("Player", 4483362458) -- Player Icon

PlayerTab:CreateDropdown({
    Name = "Select Player",
    Options = {},
    CurrentOption = "None",
    Flag = "SelectedPlayer",
    Callback = function(Value)
        selectedPlayer = Value
    end,
})

PlayerTab:CreateButton({
    Name = "Kill Selected Player",
    Callback = function()
        local targetPlayer = players:FindFirstChild(selectedPlayer)
        if targetPlayer then
            killPlayer(targetPlayer)
        else
            Rayfield:Notify({
                Title = "Error",
                Content = "Player not found!",
                Duration = 5,
            })
        end
    end,
})

PlayerTab:CreateButton({
    Name = "Kill All Players",
    Callback = function()
        for _, player in pairs(players:GetPlayers()) do
            if player ~= localPlayer then
                killPlayer(player)
            end
        end
    end,
})

PlayerTab:CreateSlider({
    Name = "Walk Speed",
    Range = {16, 100},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "WalkSpeed",
    Callback = function(Value)
        speed = Value
        updateWalkSpeed(speed)
    end,
})

-- ESP Tab
local ESPTab = Window:CreateTab("ESP", 6034287518) -- Eye Icon

ESPTab:CreateToggle({
    Name = "Enable ESP",
    CurrentValue = false,
    Flag = "ESPEnabled",
    Callback = function(Value)
        if Value then
            enableESP()
        else
            disableESP()
        end
    end,
})

-- Annoying Tab
local AnnoyingTab = Window:CreateTab("Annoying", 6031280882) -- Troll Icon

AnnoyingTab:CreateButton({
    Name = "One Punch (Set Health to 0 on Impact)",
    Callback = function()
        runService.Heartbeat:Connect(function()
            for _, player in pairs(players:GetPlayers()) do
                if player ~= localPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
                    local distance = (localPlayer.Character.PrimaryPart.Position - player.Character.PrimaryPart.Position).Magnitude
                    if distance < 5 then
                        player.Character.Humanoid.Health = 0
                    end
                end
            end
        end)
    end,
})

-- AutoFarm Tab
local AutoFarmTab = Window:CreateTab("AutoFarm", 6031302951) -- Coin Icon

AutoFarmTab:CreateToggle({
    Name = "Auto Pickup",
    CurrentValue = false,
    Flag = "AutoPickup",
    Callback = function(Value)
        autoPickupEnabled = Value
        if autoPickupEnabled then
            autoPickupItems()
        end
    end,
})

-- Gun Tab
local GunTab = Window:CreateTab("Gun", 6031763426) -- Gun Icon

GunTab:CreateToggle({
    Name = "Infinite Ammo",
    CurrentValue = false,
    Flag = "InfiniteAmmo",
    Callback = function(Value)
        if Value then
            local tool = localPlayer.Backpack:FindFirstChildOfClass("Tool")
            if tool and tool:FindFirstChild("Ammo") then
                tool.Ammo.Value = math.huge
            end
        end
    end,
})

GunTab:CreateButton({
    Name = "Double Damage",
    Callback = function()
        local tool = localPlayer.Backpack:FindFirstChildOfClass("Tool")
        if tool and tool:FindFirstChild("Damage") then
            tool.Damage.Value = tool.Damage.Value * 2
        end
    end,
})

-- Initialize UI
Rayfield:Notify({
    Title = "Troll.God Script Loaded",
    Content = "Enjoy trolling in SW2!",
    Duration = 6.5,
    Image = 4483362458
})
